#EXTRA_DIST = *.dyl /ast/*.dyl /lexer/*.dyl /parser/*.dyl /codegen/*.dyl
CLEANFILES = 

#tokenizer.AST.txt tokenizer.Lexer.txt tokenizer.Parser.txt tokenizer.CodeGen.txt dnc.txt

dylandotnet:
	mono ./dnc.exe tokenizer.AST.dyl
	mono ./dnc.exe tokenizer.Lexer.dyl
	mono ./dnc.exe tokenizer.Parser.dyl
	mono ./dnc.exe tokenizer.CodeGen.dyl
	mono ./dnc.exe dnc.dyl
	
prodscript:
	sed -e "s|\@libdir\@|$(libdir)|g" dylandotnet.in > dylandotnet
	sed -e "s|\@libdir\@|$(libdir)|g" dylandotnet4.in > dylandotnet4

installman:
	$(install_sh_PROGRAM) dylandotnet.1 $(DESTDIR)$(mandir)/man1/dylandotnet.1
	$(install_sh_PROGRAM) dylandotnet4.1 $(DESTDIR)$(mandir)/man1/dylandotnet4.1

installdoc:
	cp -r ./doc/ast-html ast-html
	tar -czf ast.tar.gz ast-html
	$(install_sh_PROGRAM) ast.tar.gz $(DESTDIR)$(prefix)/share/doc/dylandotnet-doc/ast.tar.gz
	rm -f ast.tar.gz
	rm -f -r ast-html
	
	cp -r ./doc/lexer-html lexer-html
	tar -czf lexer.tar.gz lexer-html
	$(install_sh_PROGRAM) lexer.tar.gz $(DESTDIR)$(prefix)/share/doc/dylandotnet-doc/lexer.tar.gz
	rm -f lexer.tar.gz
	rm -f -r lexer-html
	
	cp -r ./doc/parser-html parser-html
	tar -czf parser.tar.gz parser-html
	$(install_sh_PROGRAM) parser.tar.gz $(DESTDIR)$(prefix)/share/doc/dylandotnet-doc/parser.tar.gz
	rm -f parser.tar.gz
	rm -f -r parser-html
	
	cp -r ./doc/codegen-html codegen-html
	tar -czf codegen.tar.gz codegen-html
	$(install_sh_PROGRAM) codegen.tar.gz $(DESTDIR)$(prefix)/share/doc/dylandotnet-doc/codegen.tar.gz
	rm -f codegen.tar.gz
	rm -f -r codegen-html
	
installlog:
	gzip --best -c ChangeLog > changelog.gz
	$(install_sh_PROGRAM) changelog.gz $(DESTDIR)$(prefix)/share/doc/dylandotnet-doc/changelog.gz
	rm -f changelog.gz
	
install: prodscript installman installdoc installlog
	$(install_sh_PROGRAM) dylandotnet $(DESTDIR)$(bindir)/dylandotnet
	chmod a+x $(DESTDIR)$(bindir)/dylandotnet
	$(install_sh_PROGRAM) 2.0/dnu.dll $(DESTDIR)$(libdir)/dylandotnet/dnu.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet/dnu.dll
	$(install_sh_PROGRAM) 2.0/dnr.dll $(DESTDIR)$(libdir)/dylandotnet/dnr.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet/dnr.dll
	$(install_sh_PROGRAM) 2.0/tokenizer.AST.dll $(DESTDIR)$(libdir)/dylandotnet/tokenizer.AST.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet/tokenizer.AST.dll
	$(install_sh_PROGRAM) 2.0/tokenizer.Lexer.dll $(DESTDIR)$(libdir)/dylandotnet/tokenizer.Lexer.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet/tokenizer.Lexer.dll
	$(install_sh_PROGRAM) 2.0/tokenizer.Parser.dll $(DESTDIR)$(libdir)/dylandotnet/tokenizer.Parser.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet/tokenizer.Parser.dll
	$(install_sh_PROGRAM) 2.0/tokenizer.CodeGen.dll $(DESTDIR)$(libdir)/dylandotnet/tokenizer.CodeGen.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet/tokenizer.CodeGen.dll
	$(install_sh_PROGRAM) 2.0/dnc.exe $(DESTDIR)$(libdir)/dylandotnet/dnc.exe
	chmod -x $(DESTDIR)$(libdir)/dylandotnet/dnc.exe
	
	$(install_sh_PROGRAM) dylandotnet4 $(DESTDIR)$(bindir)/dylandotnet4
	chmod a+x $(DESTDIR)$(bindir)/dylandotnet4
	$(install_sh_PROGRAM) 4.0/dnu.dll $(DESTDIR)$(libdir)/dylandotnet4/dnu.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet4/dnu.dll
	$(install_sh_PROGRAM) 4.0/dnr.dll $(DESTDIR)$(libdir)/dylandotnet4/dnr.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet4/dnr.dll
	$(install_sh_PROGRAM) 4.0/tokenizer.AST.dll $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.AST.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.AST.dll
	$(install_sh_PROGRAM) 4.0/tokenizer.Lexer.dll $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.Lexer.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.Lexer.dll
	$(install_sh_PROGRAM) 4.0/tokenizer.Parser.dll $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.Parser.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.Parser.dll
	$(install_sh_PROGRAM) 4.0/tokenizer.CodeGen.dll $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.CodeGen.dll
	chmod -x $(DESTDIR)$(libdir)/dylandotnet4/tokenizer.CodeGen.dll
	$(install_sh_PROGRAM) 4.0/dnc.exe $(DESTDIR)$(libdir)/dylandotnet4/dnc.exe
	chmod -x $(DESTDIR)$(libdir)/dylandotnet4/dnc.exe
	
uninstallman:
	rm $(DESTDIR)$(mandir)/man1/dylandotnet.1
	rm $(DESTDIR)$(mandir)/man1/dylandotnet4.1

uninstalldoc:
	rm -f -r $(prefix)/share/doc/dylandotnet-doc

uninstall: uninstallman uninstalldoc
	rm -f $(DESTDIR)$(bindir)/dylandotnet
	rm -r -f $(DESTDIR)$(libdir)/dylandotnet
	rm -f $(DESTDIR)$(bindir)/dylandotnet4
	rm -r -f $(DESTDIR)$(libdir)/dylandotnet4
	
distclean:
	
tarball:
	rm -f config.status
	rm -f config.log
	rm -f Makefile
	mkdir -p ./../$(distdir)
	cp -r * ./../$(distdir)
	tar -czf ./../$(distdir).tar.gz ./../$(distdir)
	rm -f -r ./../$(distdir)

all:
	echo "Hello World"

